# Project Log - 2026-02-22

## Progress

- Monitored Temporal workflow status for all backfill jobs submitted on 2026-02-21
- Cancelled 4 struggling workflows (heartbeat timeout) and re-submitted with windowed backfills
- Oportun sequential backfill (51 1-day windows) confirmed complete from yesterday
- Most clusters fully done; 6 customers still in progress on voice-prod and us-east-1-prod

## Backfill Verification Results

### Completed Clusters

| Cluster | Customers | Backfill Status | Notes |
|---------|-----------|-----------------|-------|
| us-west-2-prod | 30 | 30/30 complete | oportun: 51-day sequential backfill completed |
| chat-prod | 3 | 3/3 complete | verizon-wireless took ~4.5h, others quick |
| schwab-prod | 1 | 1/1 complete | |
| eu-west-2-prod | 0 | N/A | No data in range |
| ap-southeast-2-prod | 0 | N/A | No data in range |
| ca-central-1-prod | 0 | N/A | No data in range |

### voice-prod (14/17 complete, 3 in progress)

| Customer | Status | Notes |
|----------|--------|-------|
| 14 customers | Complete | brinks-care, cox-tech-support, cox-retention, etc. |
| hilton | In progress | 5-day windows (window 2/10 running). Script running in background |
| vivint | In progress | Original full-range workflow, 22+ hours, attempt=1, healthy |
| holidayinn-transfers | In progress | Recent workflow, attempt=1, healthy |

### us-east-1-prod (41/44 complete, 3 in progress)

| Customer | Status | Notes |
|----------|--------|-------|
| 41 customers | Complete | alaska-air, sunbit, rentokil, rcg, propel, nrg, etc. |
| united-east | Partial | 5-day windows. Window 1/11 completed (~6h). Remaining 10 queued |
| marriott | Partial | 10-day windows. Window 1/6 completed (~3h 19m). Remaining 5 queued |
| spirit | Partial | 10-day windows. Window 1/6 completed (~3h). Remaining 5 queued |

## Struggling Workflows — Analysis and Resolution

4 customers had heartbeat timeout failures on their full-range (51-day) backfill workflows:

| Customer | Cluster | Scorecards | Scores | Attempts | Action |
|----------|---------|------------|--------|----------|--------|
| hilton | voice-prod | 4.2M | 57.3M | 2 | Cancelled, re-running 5-day windows |
| united-east | us-east-1-prod | 10.7M | 61.0M | 4 | Cancelled, re-running 5-day windows |
| marriott | us-east-1-prod | 1.4M | 18.2M | 2 | Cancelled, re-running 10-day windows |
| spirit | us-east-1-prod | 1.5M | 4.7M | 2 | Cancelled, re-running 10-day windows |

### Window Size Selection

Compared against known baselines:
- oportun (307K sc/day, needed 1-day splits)
- cvs (95K sc/day, needed 1-day splits)

Selected based on relative volume:
- united-east (210K sc/day) → 5-day windows
- hilton (82K sc/day) → 5-day windows
- marriott (28K sc/day) → 10-day windows
- spirit (30K sc/day) → 10-day windows

### First Attempt: 1-hour Script Timeout

First run used `WORKFLOW_TIMEOUT=3600s`. All 4 timed out — but the workflows themselves were healthy (attempt=1, no failures). They just needed more time:

| Customer | Window Size | Workflow Duration | Script Timeout |
|----------|-------------|-------------------|----------------|
| hilton | 5-day | ~2h 15m | Exceeded 1h |
| united-east | 5-day | 1h–6h | Exceeded 1h |
| marriott | 10-day | ~3h 19m | Exceeded 1h |
| spirit | 10-day | ~3h | Exceeded 1h |

All 4 first-window workflows eventually completed on Temporal after the script timed out.

### Second Attempt: 8-hour Script Timeout

Re-ran with `WORKFLOW_TIMEOUT=28800s` (8h), skipping already-completed window 1:
- Script: `/tmp/sequential_backfill_remaining.py` (background task b990899)
- hilton: 10 remaining 5-day windows (~2h each)
- united-east: 10 remaining 5-day windows
- marriott: 5 remaining 10-day windows
- spirit: 5 remaining 10-day windows

Currently processing hilton window 2 (Jan 6–11).

## Remaining Work

1. **Wait for sequential backfill script to complete** all 4 customers
2. **Monitor vivint and holidayinn-transfers** on voice-prod (still running original full-range workflows)
3. **Spot-check ClickHouse counts** after all workflows complete to verify data integrity
