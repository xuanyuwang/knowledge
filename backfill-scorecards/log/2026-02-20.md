# Project Log - 2026-02-20

## Progress

- Created rollout tooling for appeal scorecard cleanup across all customers
- Scripts ready; execution planned for weekend

## Details

### New scripts

1. **`list_ch_databases.sh`** — Read-only discovery of all ClickHouse databases on a cluster with scorecard data in the 2026-01-01 to 2026-02-21 date range. Outputs database name, scorecard count, and score count.

2. **`cluster_cleanup.py`** — Main orchestration script. Per-cluster, per-customer cleanup:
   - Discovers all databases with scorecard data
   - Processes customers in batches of 10
   - For each customer: delete ClickHouse data → wait for mutations → run backfill
   - Large customers (cvs, oportun) use 1-day sequential splits (51 days)
   - Skips mutualofomaha (already completed)
   - JSON-based tracking in `tracking/<cluster>.json` for resume after interruption
   - `--status` and `--reset <customer>` commands

3. **`tracking/`** directory created for per-cluster JSON tracking files

### Execution plan (weekend)

Run one cluster at a time:
1. voice-prod (~49 customers, skip mutualofomaha)
2. us-east-1-prod (~86 customers)
3. us-west-2-prod (~80 customers, cvs + oportun need 1-day splits)
4. chat-prod (~28 customers)
5. eu-west-2-prod (~6 customers)
6. schwab-prod (~5 customers)
7. ap-southeast-2-prod (~4 customers)
8. ca-central-1-prod (~2 customers)

### Context

PR #25653 (CONVI-6227, merged 2026-02-11) filters out appeal request scorecards during reindex. But reindex only INSERTs — old appeal data lingers in ClickHouse. Mutual of Omaha was cleaned up on 2026-02-19. This rollout covers all remaining customers across all 8 clusters.
