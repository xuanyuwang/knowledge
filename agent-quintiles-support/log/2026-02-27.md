# Project Log - 2026-02-27

## Progress

- Investigated LeaderboardPerCriterion FE component in detail
- **Key finding: no BE or FE changes needed for per-criterion quintile**
  - LeaderboardPerCriterion already sends `groupBy: [AGENT]` + `criterionIdentifiers: [selected]` when a criterion is picked from the dropdown
  - The criterion filter restricts data before ranking, so agents are already ranked within the selected criterion's data
  - A new request fires on each criterion change → quintile re-computed per criterion
- Updated `per-criterion-quintile-investigation.md` with this finding
- BE PR [go-servers #25968](https://github.com/cresta/go-servers/pull/25968) is a defensive correctness fix for `[AGENT, CRITERION]` grouped requests, but not required by any current FE use case

## Details

### LeaderboardPerCriterion quintile request flow
1. User selects criterion from dropdown
2. `filtersState.scorecardTemplateItems = [selectedCriterion.value]` (line 165)
3. Quintile request: `groupBy: [AGENT]`, `criterionIdentifiers: [selected]` (lines 175-180)
4. Backend filters to that criterion, ranks all agents → returns per-criterion quintile
5. `quintileRankByResourceName` map built from response (lines 181-192)
6. Applied to rows (line 278)

No code changes needed anywhere. The existing architecture already handles per-criterion quintile correctly.

### Clarification on the `[AGENT, CRITERION]` request
The request with `groupBy: [AGENT, CRITERION]` and empty `criterionIdentifiers` seen in network tab is from **LeaderboardByScorecardTemplateItem** (2nd table), not LeaderboardPerCriterion. That table's quintile comes from a separate `[AGENT]`-only request.
