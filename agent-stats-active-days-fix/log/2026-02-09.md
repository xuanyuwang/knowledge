# Project Log - 2026-02-09

## Progress

- Investigated and fixed the "N/A" bug in Agent Leaderboard Active Days for Alaska Air
- Created PR #25613 with the fix (FULL OUTER JOIN + COALESCE + Go guard)
- Fixed lint error (gocritic ifElseChain → switch statement)
- Created Notion documentation page for non-engineers
- Verified fix on staging (cresta/walter-dev) and production (Alaska Air)
- Investigated two CSM-reported data questions for today's data
- Identified cron-label-conversations 30-minute delay as explanation for CSM question

## Details

### Bug Investigation

The bug manifested after enabling `exclude_ingestion_pipeline_from_agent_stats` for Alaska Air. Agents with only source 8 conversations on certain days showed "N/A" instead of "0".

Root cause: LEFT JOIN between `convs` (filtered by source) and `convs_with_aa` (no source filter) drops rows when `convs` has no data for a day.

### Fix Applied

1. Changed LEFT JOIN to FULL OUTER JOIN in SQL
2. Added COALESCE for NULL handling from outer join
3. Added `totalAgentCount > 0` guard in Go to prevent source-8-only AA rows from showing as "1"

### Production Verification

Tested on Alaska Air ClickHouse. Agent `a86442ed872e344b` on 2026-01-26 confirmed the bug: row present in FULL OUTER JOIN (`total=0, active=1`) but missing in LEFT JOIN.

### CSM Investigation

- Agent `a86442ed872e344b`: 25 conversations today but only 2 in `conversation_with_labels_d` — cron delay
- Agent `76515806a32dcf91`: Query shows `total=1, active=1` — CSM likely had timezone/cache issue

### Notion Documentation

Created comprehensive guide at https://www.notion.so/cresta/3024a587b06180cbace3faa4fd6c8b14 covering display values, tooltips, AA tagging logic, known limitations, and scenario breakdowns.
