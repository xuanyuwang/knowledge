# Project Log - 2025-02-17

## Progress

- Created project folder `convi-6247-agent-only-filter` for CONVI-6247.
- Documented scope: add request field to analytics APIs (using `ParseUserFilterForAnalytics`), pass through to BE; FE (Performance, Leaderboard, Agent Assist) to use `listAgentOnly=true` for agent views and `false`/default for manager views.
- **Clarification:** Add a **page-wide filter option** (like Scorecard Status) on Performance, Leaderboard, Agent Assist; the filter drives the value passed to the new API field (agent-only vs include managers).
- **Investigation:** Traced how Scorecard Status is implemented in director repo (Performance: usePerformanceFilters + OrderedFilterBar + useUnifiedFiltersStore; Leaderboard: useLeaderboardsFilters, same pattern). Wrote concrete implementation plan in page-wide-filter-investigation.md: FilterKey, state field, BooleanFilter, persistence, and pass-through to useInsightsRequestParams / QA request params; Manager tab disable.
- **Phase 1 (proto):** Added `filter_to_agents_only` to the 6 split-assistance request messages in `cresta-proto/cresta/v1/analytics/analytics_service.proto` (RetrieveSuggestionStats, RetrieveSummarizationStats, RetrieveSmartComposeStats, RetrieveNoteTakingStats, RetrieveGuidedWorkflowStats, RetrieveKnowledgeBaseStats). Other analytics requests already had the field. Task 1.2 (wire into handlers in go-servers) remains. **PR:** [cresta-proto #7872](https://github.com/cresta/cresta-proto/pull/7872).

## Details

- **Linear:** CONVI-6247 — Add filter for agent-only manager inclusion in Performance.
- **Relation to insights-user-filter:** Same APIs and `ParseUserFilterForAnalytics`; this project adds an explicit request parameter and FE wiring instead of hardcoding `listAgentOnly` per API.
- **Example:** Agent tab in Leaderboard → pass `listAgentOnly=true`; Manager tab → pass `listAgentOnly=false`.

## Next Steps

- BE: Wire `req.FilterToAgentsOnly` into each analytics API handler → `ParseUserFilterForAnalytics(..., listAgentOnly)` (Phase 1.2). Regenerate proto stubs after proto changes.
- FE: Follow [implementation-plan.md](implementation-plan.md) Phase 2 onward — FilterKey, state, BooleanFilter, Performance + Leaderboard hooks, API pass-through; disable on Manager tab.
- Agent Assist: Audit and add filter if in scope.

## Related

- [CONVI-6247](https://linear.app/cresta/issue/CONVI-6247/add-this-filter-for-agent-only-manager-inclusion-filter-in-performance)
- [insights-user-filter/](../insights-user-filter/) — API refactoring context
- [insights-user-filter/apis-by-leaderboard-tab.md](../insights-user-filter/apis-by-leaderboard-tab.md)
