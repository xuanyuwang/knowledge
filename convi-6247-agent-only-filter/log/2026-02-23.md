# Project Log - 2026-02-23

## Progress

- Reverted Leaderboard file changes from PR #16777 (PR is Performance-only now; Leaderboard belongs in Phase 4).
- Fixed HIGH severity bug: filter vanishes from filter bar when user selects "No".
- Addressed all remaining PR review comments.

## Details

### Reverted Leaderboard changes

Removed `useLeaderboardsFilters.tsx` changes and `leaderboards.filters.agents-only` locale key from the PR. The Leaderboard filter state (`listAgentOnly` in Pick type, `LocalStorageLeaderboardsFiltersState`, initial state, serialization) will be added in Phase 4 alongside Leaderboard UI + API wiring.

Updated PR #16777 description to reflect Performance-only scope.

### Fixed: filter vanishes when set to "No" (cursor[bot] HIGH)

**Root cause:** `useSingleBooleanLevelSelect`'s `hasAValue` function uses `state || filterHasAppliedPresetValue(options)`. Since `false` is falsy in JS, setting the filter to "No" (include managers) causes `hasAValue` to return `false`, which tells the filter bar the filter has no value — removing it from the UI.

This pattern works for `excludeDeactivatedUsers` (default `false`, only shows when `true`), but breaks for `listAgentOnly` where both boolean values are meaningful active states.

**Fix:** Overrode `hasAValue` in `useListAgentOnlyLevelSelect` to use `state !== undefined` instead of the default truthiness check:

```typescript
const base = useSingleBooleanLevelSelect('Agents only', 'Yes');
return useMemo(
  () => ({
    ...base,
    hasAValue: (state: boolean | undefined) => state !== undefined,
  }),
  [base]
);
```

### PR comment triage

| # | Comment | Source | Status |
|---|---------|--------|--------|
| 1 | Missing `?? true` fallback in Leaderboard | cursor[bot] | N/A — file reverted |
| 2 | Missing `?? true` fallback in Performance | cursor[bot] | Already fixed previously |
| 3 | Unmemoized `getFilterSelectionMenuOptions()` | cursor[bot] | N/A — reverted to static constant |
| 4 | `i18n.language` dependency for memoized options | coderabbitai | N/A — reverted to static constant |
| 5 | i18n consistency across all menu options | coderabbitai (nitpick) | Out of scope |
| 6 | Hardcoded strings in level select hook | coderabbitai (nitpick) | Out of scope — matches existing pattern |
| 7 | Filter vanishes when set to "No" | cursor[bot] (HIGH) | **Fixed** |

## Next Steps

- Phase 4: Leaderboard page — add filter state, UI, and API wiring (disable on Manager tab)
- Phase 6: Agent Assist page (TBD if in scope)
