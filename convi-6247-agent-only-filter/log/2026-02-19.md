# Project Log - 2026-02-19

## Progress

- Completed **Phase 3 (Performance page filter)** — "Agents only" BooleanFilter on Performance page.
- Combined Phase 2 + Phase 3 into a single PR: [director #16777](https://github.com/cresta/director/pull/16777).
- Closed separate Phase 3 PR (#16791); cleaned up Phase 3 branch and worktree.

## Details

### Phase 3 changes (5 files, 1 new module)

1. **New: `list-agent-only-level-select/`** — `useListAgentOnlyLevelSelect` hook using `useSingleBooleanLevelSelect('Agents only', 'Yes')`, same pattern as deactivated users.
2. **`filters/index.ts`** — Barrel export for the new module.
3. **`usePerformanceFilters.tsx`**:
   - `getInitialFiltersState`: `listAgentOnly: true`
   - `filterStateToLocalState` / `localStateToFilterState`: serialize/deserialize `listAgentOnly`
   - `components` useMemo: registered `BooleanFilter` for `FilterKey.LIST_AGENT_ONLY` (label "Agents only", default "Yes", not clearable)
   - Added `filters.listAgentOnly` to dependency array
4. **`utils.ts`**:
   - `FILTER_SELECTION_MENU_OPTIONS`: "Agents only" in general section
   - `FILTERS_SELECTION_STATE_ACCESSORS`: `LIST_AGENT_ONLY → 'listAgentOnly'`
   - `FILTERS_SELECTION_HOOKS`: `LIST_AGENT_ONLY → useListAgentOnlyLevelSelect`

### PR consolidation

- Initially created separate Phase 3 PR (#16791 targeting Phase 2 branch).
- Merged both phases into single PR #16777 for simplicity.
- Cleaned up: deleted Phase 3 remote/local branch and worktree (`director-convi-6247-phase3`).

### i18n for Agents Only filter

- Added en-US locale keys under `performance.filters` (`agents-only`, `agents-only-yes`, `agents-only-no`) and `leaderboards.filters` (`agents-only`)
- Converted `FILTER_SELECTION_MENU_OPTIONS` static constant → `getFilterSelectionMenuOptions()` function using `getI18n().getFixedT()` (matches Leaderboard `getFilterMenuOptions()` pattern)
- `usePerformanceFilters.tsx`: uses project's `useTranslation` from `../../../../hooks` (not `react-i18next` directly — lint rule `no-restricted-imports`), `t('agents-only', ...)` for BooleanFilter label and displayText, `t` added to useMemo deps

### Worktree env fixes

- `yarn install --immutable` fixed `eslint-plugin-react-refresh` version mismatch (0.4.26 → 0.5.0)
- `PATH="$PWD/node_modules/.bin:$PATH"` needed for `lerna` in pre-commit hook

## Next Steps

- Phase 4: Leaderboard page filter UI (same BooleanFilter pattern, disable on Manager tab)
- Phase 5: API pass-through (replace hardcoded `filterToAgentsOnly: true` with state value)
